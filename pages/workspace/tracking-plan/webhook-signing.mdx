---
layout: 'guide'
title: 'Webhook signing'
# abstract: 'Learn about how to secure your webhook endpoint'
---

import Link from '../../../components/Link';


## Check the webhook signatures

### Verify the that only Avo is sending you events

Avo will sign each webhook call it sends to your endpoint by including a [Jwt](https://Jwt.io) token in each request `authorization` header. 
This allows you to verify that the events were sent by Avo and not by a third party. 
Before you can verify signatures, you need to retrieve your publishing webhook's secret from your Webhook publishing page in Avo.
Avo generates a unique secret key for each publishing webhook endpoint. If you use multiple endpoints, you must obtain a secret for each one you want to verify the signature on.
<p>
  <img
    src={require('../../../images/signing-secret.png')}
    width="600px"
    alt="The image shows a webhook integration and a button at the top labeled Webhook Secret which if clicked reveals the secret"
/>
</p>


### Verifying signatures

The `authorization` header included in each request contains a Jwt token that can be used to validate the request using the secret given in the webhook configuration dashboard.


Avo generates signatures using a hash-based message authentication code (HMAC) with SHA-256.
```json
{
  "alg": "HS256",
  "typ": "Jwt"
}
```
<br />

### Verify signature header

#### 1. Store your secret safely.
The secret you received in our webhook configuration, should be stored in a secret manager or an env variable on your server.

#### 2. Validate the authorization header

Using a [Jwt library](https://Jwt.io/libraries), verify that the token is valid.


 ```pseudocode

    var token = request.headers.get('authorization');
    token = token.split(" ")[1]; //Remove "Bearer " from the token
    Jwt.verify(token, _secret); // Some libraries require try catch around this.
 ```

#### 3. Extra security (optional)

Each Jwt token has in it's payload an "iat"(Issued at time) which is a timestamp you can use for extra security to match with the current timestamp. That way you can make sure the timestamp in the request is not very old.

```json
{
  "iat": 1652306791  //Unix timestmap in seconds
}
```