---
layout: 'guide'
title: 'Setting up custom destinations'
---

import Link from '../../components/Link';

Destination interface is a set of hook methods that you implement to route data from Avo to particular analytics destination. Avo triggers specific methods when you call the Avo functions to send events. 
It provides the data ready to be sent to any analytics destination.

You can use the destination interface with any analytics platform, please <Link passHref href="/help/troubleshooting"><a>contact us</a></Link> if you are unsure of what is
the best solution for you.

To get started using a destination interface you do the following:

1. Create a Custom Destination in the Connections tab
2. Pull the updated code by doing `avo pull` in the Avo CLI
3. Initialize Avo with a custom destination
4. Fill in the empty methods for sending the data to your analytics destination

## Destination Interface overview

We will be referencing Avo _functions_, _events_, _actions_ and other Avo concepts in this document. Please read <Link passHref href="/workspace/tracking-plan"><a>the Tracking Plan doc</a></Link> and subdocs to get familiar with Avo concepts.

With a destination interface you'll get access to callback methods for Avo actions. The Avo generated code triggers the callbacks when corresponding <Link passHref href="/implementation/avo-functions-overview"><a>Avo functions</a></Link> are called.

> Available event actions in Avo
>
> The callback methods mirror the Avo Actions you set up for given Avo Event in your tracking plan in your workspace.
> Learn how to attach actions to events in <Link passHref href="/workspace/tracking-plan/events#actions"><a>the Tracking Plan section</a></Link>.

### Hook methods

- `make`: Triggered during Avo initialization.
  Here you will usually initialize an analytics SDK with the provided apiKey parameter. You can adjust the initialization based on the `env` parameter.
  This method is optional, if analytics SDK has already been initialized before you can skip it.

  Example: `analytics.init(apiKey)`

- `logEvent`: All your analytics events are managed in the Tracking Plan in Avo. Each event gets a generated Avo function. Avo events can have a Log Event action attached. This callback is triggered when an Avo function with Log Event action is called.
  Here you perform the actual event tracking, calling the track/log methods of the analytics SDK. Event name and event properties are provided as parameters.

  Example: `analytics.track(eventName, eventProperties)`

- `identify`: You can add the Identify User action to an event in the Tracking Plan in Avo. When calling an Avo function that includes the Identify User action you'll need to provide a user ID. Calling an Avo function that has the Identify User action will trigger this callback.
  The main use cases are signup and login.
  Here you would pass the user ID to the analytics SDK for it to create a new user or attach a session to an existing user.

  Example: `analytics.identify(userId)`

- `unidentify`: If you call an Avo function with the Unidentify User action, this callback will be triggered.
  Here you would call an analytics SDK method to detach subsequent actions from the currently identified user.

  Example: `analytics.identify(null)`

- `revenue`: If you add a `Log Revenue` action to Avo Function this callback will be invoked.
  Here you would log the revenue to your analytics destination, many of them have a special method to log revenue.

  Example: `analytics.revenue(productId, quantity, price)`

- `page`: If you add a `Log Page View` action to Avo Function this callback will be invoked.
  Here you would report navigation to your analytics destination.

  Example: `analytics.page(pageName, eventProperties)`

- `setUserProperties`: You can add user properties to events in the Avo dashboard. When an Avo function with attached user properties is called, this callback is triggered.
  Here you would attach user properties to the currently identified user in your analytics platform.

  Example: `analytics.setUserProperties(userId, userProperties)`

- `setGroupProperties`: You can update various group properties along with events in the Avo dashboard. When an Avo function with attached groups and group properties is called, this callback is triggered.
  Here you would update the properties for specified groups.

  Example: `mixpanel.get_group(groupType, groupId).set(groupProperties)`

- `addCurrentUserToGroup`: You can add groups and group properties to an event and set the event to associate the currently identified user with the provided groups.
  Can optionally update group properties along the way.

Example: ` analytics.group(groupType, { name: groupId, ...groupProperties, });`

- `logEventWithGroups`: this call is same as the `logEvent` call described above, except it also associates this particular event with a group.

Example: ` mixpanel.track_with_groups(eventName, eventProperties, { groupType: groupId, });`

### Implementation instructions

Below are instructions on how to initialize Avo with a destination interface for
each of the supported languages:

- Web
  - <Link passHref href="/implementation/reference/javascript#destination-interface-example"><a>JavaScript</a></Link>
  - <Link passHref href="/implementation/reference/typescript#destination-interface-example"><a>TypeScript</a></Link>
  - <Link passHref href="/implementation/reference/rescript#destination-interface-example"><a>Rescript</a></Link>
  - <Link passHref href="/implementation/reference/reasonml#destination-interface-example"><a>ReasonML</a></Link>
- Mobile
  - iOS
    - <Link passHref href="/implementation/reference/objc#destination-interface-example"><a>Objective-C</a></Link>
    - <Link passHref href="/implementation/reference/swift#destination-interface-example"><a>Swift</a></Link>
  - Android
    - <Link passHref href="/implementation/reference/java#destination-interface-example"><a>Java</a></Link>
    - <Link passHref href="/implementation/reference/kotlin#destination-interface-example"><a>Kotlin</a></Link>
  - React Native
    - <Link passHref href="/implementation/reference/javascript#destination-interface-example"><a>JavaScript</a></Link>
    - <Link passHref href="/implementation/reference/typescript#destination-interface-example"><a>TypeScript</a></Link>
    - <Link passHref href="/implementation/reference/rescript#destination-interface-example"><a>Rescript</a></Link>
    - <Link passHref href="/implementation/reference/reasonml#destination-interface-example"><a>ReasonML</a></Link>
- Backend
  - Node.js
    - <Link passHref href="/implementation/reference/javascript#destination-interface-example"><a>JavaScript</a></Link>
    - <Link passHref href="/implementation/reference/typescript#destination-interface-example"><a>TypeScript</a></Link>
    - <Link passHref href="/implementation/reference/rescript#destination-interface-example"><a>Rescript</a></Link>
    - <Link passHref href="/implementation/reference/reasonml#destination-interface-example"><a>ReasonML</a></Link>
  - <Link passHref href="/implementation/reference/java#destination-interface-example"><a>Java</a></Link>
  - <Link passHref href="/implementation/reference/php#destination-interface-example"><a>PHP</a></Link>
  - <Link passHref href="/implementation/reference/python#destination-interface-example"><a>Python</a></Link>
  - <Link passHref href="/implementation/reference/ruby#destination-interface-example"><a>Ruby</a></Link>
  - <Link passHref href="/implementation/reference/csharp#destination-interface-example"><a>C#</a></Link>
- Game Engines
  - <Link passHref href="/implementation/reference/csharp#destination-interface-example"><a>C#</a></Link>

## Snowplow destination interface

Snowplow SDK's tracking interface is a little different from the common event tracking libraries and working with Snowplow through Avo is slightly different too.

The main idea stays the same though, when you initialize the Avo analytics wrapper generated for you, you pass an object with callbacks that will be called by Avo after all the validations are done.

The callback object has the following interface:

```pseudocode
func make(env: AvoEnv)

func trackSelfDescribingEvent(schema: String, data: Dictionary, 
        contexts: List<Pair<schema: String, data: Dictionary>>)

func trackPageView(title: String)

func identify(userId: String)

func unidentify()
```

> Snowplow context is basically a properties object (a set of property names and values) plus the Snowplow schema name. In code we represent the Snowplow context as a combination of two fields: string `schema`, that is pinned in the Avo UI and you don't need to provide it in the code when calling the Avo Function and the data, which is an object. You provide the values for that object's fileds when calling the Avo function.

In each callback you would do a specific action, that maps directly to the Snowplow SDK. Code snippets for various programming languages are are available below.

1. `make` - here you would initialize your Snowplow SDK, you can also skip this callback if you already have the Snowplow SDK initialized, the parameter will be one of `AvoEnv.Dev`, `AvoEnv.Prod`, `AvoEnv.Staging`

2. `trackSelfDescribingEvent` - this callback provides you all the data needed to track a self describing event

3. `trackPageView` - this callback is for tracking page views, with the page title as parameter, there is a corresponding method in the Snowplow SDK

4. `identify` - this callback is to assign an id of the current user, which is the call's parameter, in Snowplow it's done by assigning the user id in the Subject config

5. `unidentify` - this callback is for removing current user's identification

### Implementation instructions

- <Link passHref href="/implementation/reference/kotlin#snowplow-interface"><a>Kotlin</a></Link>
- <Link passHref href="/implementation/reference/swift#snowplow-interface"><a>Swift</a></Link>
- <Link passHref href="/implementation/reference/javascript#snowplow-interface"><a>JavaScript</a></Link>
- <Link passHref href="/implementation/reference/typescript#snowplow-interface"><a>TypeScript</a></Link>

## Managed destination (legacy)

When using some language + destination combinations you can pick Avo managed destination approach. It's a legacy feature that will be deprecated soon.

If you choose Avo to manage your destination, you'll still have to include the destination SDK in your application, but the initialization of the library and all event actions: `Log Event`, `Update User Properties`, `Identify User`, `Unidentify User`, `Log Revenue`, `Log Page View`, `Update Groups`, will be handled by the <Link passHref href="/implementation/avo-functions-overview"><a>Avo Functions in the Avo generated code</a></Link>.

- Avo will initialize the analytics SDK with the API key you provided in the Avo UI corresponding to the specified environment when you initialize Avo
- **Log Event**: Avo will call the track method of the analytics SDK (e.g. `track(eventName, eventProperties)` in the Segment SDK) when an Avo Function corresponding to an event with `Log Event` action is called and will include the event and system properties in the call.
- **Log event with Group**: Avo will associate the track method with the specified group if the event is associated with a group in the `Log Event` action.
- **Update User Properties**: Avo will call the user properties method of the analytics SDK (e.g. `identify(userId, userProperties)` in the Segment SDK) when an Avo Function corresponding to an event with `Update User Properties` action is called and will include the user properties in the call.
- **Identify User**: Avo will call the identify method of the analytics SDK (e.g. `identify(userId)` in the Segment SDK) when an Avo Function corresponding to an event with `Identify User` action is called.
- **Unidentify User**: Avo will call the unidentify method of the analytics SDK (e.g. `identify(null)` in the Segment SDK) when an Avo Function corresponding to an event with `Unidentify User` action is called.
- **Log Revenue**: Avo will call the revenue method of the analytics SDK (e.g. `track("revenue", {"revenue": amount})` in the Segment SDK) when an Avo Function corresponding to an event with `Log Revenue` action is called.
- **Log Page View**: Avo will call the page method of the analytics SDK (e.g. `page(pageName, eventProperties)` in the Segment SDK) when an Avo Function corresponding to an event with `Log Page View` action is called and will include the event and system properties in the call.
- **Associate user with Group**: Avo will associate current user with the specified group when an Avo event with the 'Update Groups' action is triggered.
- **Update Groups Properties**: Avo will update specified group metadata when an Avo event with the 'Update Groups' action is triggered.

> Learn more about Avo actions and how to attach them to events in <Link passHref href="/workspace/tracking-plan/events#actions"><a>the Tracking Plan section</a></Link>.